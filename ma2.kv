#:kivy 1.10.0

<TrackWidget>:
    canvas:

<PatternWidget>:
    canvas:

#<SongViewWidget>:

<Widget>:
    font_name: 'RobotoMono-Regular'
    font_size: dp(17)

<RetroButton@Button>:
    text: ''
    
    background_normal: ''
    background_color: 0,0,0,1
    
    canvas:
        Color:
            rgb: (.8,.8,.8)
        Line:
            rectangle: self.x+3, self.y+3, self.width-6, self.height-6
            width: 1.2
            joint: 'miter'
            
    Label:
        text_size: self.size
        font_name: root.font_name
        text: root.text
        halign: 'center'

<Ma2Widget>:

    theTrkWidget: thisTrkWidget
    thePtnWidget: thisPtnWidget
    
    btnTitle:     btnTitleID
    btnTrkInfo:   btnTrkInfoID
    btnPtnTitle:  btnPtnTitleID
    btnPtnInfo:   btnPtnInfoID
    btnNotePitch: btnNotePitchID
    btnNoteOn:    btnNoteOnID
    btnNoteLen:   btnNoteLenID
    btnNoteVel:   btnNoteVelID

    BoxLayout:
        orientation: "vertical"
        size: root.size        
        
        BoxLayout:
            orientation: "horizontal"
            height: root.height * 0.05
            size_hint_y: None
            
            RetroButton:
                id: btnTitleID
                on_press: root.pressTitle()
            RetroButton:
                on_press: root.pressTrkAdd()
                text: 'TRK +'
                size_hint_x: 0.1
            RetroButton:
                on_press: root.pressTrkDel()
                text: 'TRK -'
                size_hint_x: 0.1
            RetroButton:
                id: btnTrkInfoID
                on_press: root.pressTrkInfo()
                text: 'TRK Info (Name, Inst, Transpose)'
                size_hint_x: 0.4
                
        TrackWidget:
            id: thisTrkWidget
            height: 280
            size_hint_y: None
            
        BoxLayout:
            orientation: "horizontal"
            height: root.height * 0.05
            size_hint_y: None
            RetroButton:
                on_press: root.pressModAdd()
                text: "MOD+"
                size_hint_x: 0.15
            RetroButton:
                on_press: root.pressModDel()
                text: "MOD-"
                size_hint_x: 0.15
            RetroButton:
                on_press: root.pressPtnLast()
                text: "<"
                size_hint_x: 0.15
            RetroButton:        
                id: btnPtnTitleID
                on_press: root.pressPtnTitle()
                text: "PTN: bad performance"
            RetroButton:
                on_press: root.pressPtnNext()
                text: ">"
                size_hint_x: 0.15
            RetroButton:
                on_press: root.pressPtnAdd()
                text: "PTN+"
                size_hint_x: 0.15
            RetroButton:
                on_press: root.pressPtnDel()
                text: "PTN-"
                size_hint_x: 0.15
            RetroButton:
                id: btnPtnInfoID
                on_press: root.pressPtnInfo()
                text: "PAT LEN (Beats)"
                size_hint_x: 0.4

        PatternWidget:
            id: thisPtnWidget
            
        BoxLayout:
            orientation: "horizontal"
            height: root.height * 0.05
            size_hint_y: None
            RetroButton:
                on_press: root.pressNoteAdd()
                text: "NOTE +"
            RetroButton:
                on_press: root.pressNoteDel()
                text: "NOTE -"
            RetroButton:
                id: btnNotePitchID
                on_press: root.pressNotePitch()
                text: "NOTE PITCH (or Drum)"
            RetroButton:
                id: btnNoteOnID
                on_press: root.pressNoteOn()
                text: "NOTE ON"
            RetroButton:
                id: btnNoteLenID
                on_press: root.pressNoteLen()
                text: "NOTE LEN"
            RetroButton:
                id: btnNoteVelID
                on_press: root.pressNoteVel()
                text: "NOTE VEL"

        BoxLayout:
            orientation: "horizontal"
            height: root.height * 0.05
            size_hint_y: None
            RetroButton:
                on_press: root.pressLoadCSV()
                text: "Load .ma2"
            RetroButton:
                on_press: root.pressSaveCSV()
                text: "Save .ma2"
            RetroButton:
                on_press: root.pressBuildCode()
                text: "Export GLSL"
#           RetroButton:
#               text: "Import GLSL"
